{"version":3,"sources":["../../src/models/Query.js"],"names":["module","exports","getStatistics","schoolId","err","data","school","statistics","schoolTeachers","schoolStudents","schoolCourses","schoolSubjects","schoolProjects","schoolCards","schoolLangs","profiles","courses","subjects","projects","cards","langs","featured","School","findById","coursesId","Course","getBySchool","subjectsId","Subject","getByCourses","projectsId","Project","getBySubjects","cardsId","Card","getByProjects","langsId","Lang","getByCards","profilesId","Profile","getTeachers","getStudents"],"mappings":"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","file":"Query.js","sourcesContent":["import to from '../to';\r\nimport Profile from './Profile';\r\nimport User from './User';\r\nimport School from './School';\r\nimport Course from './Course';\r\nimport Subject from './Subject';\r\nimport Project from './Project';\r\nimport Card from './Card';\r\nimport Lang from './Lang';\r\n\r\nmodule.exports.getStatistics = async (schoolId)=>{\r\n  let err, data, school;\r\n  var statistics= {\r\n    schoolTeachers: [],\r\n    schoolStudents: [],\r\n    schoolCourses: [],\r\n    schoolSubjects: [],\r\n    schoolProjects: [],\r\n    schoolCards: [],\r\n    schoolLangs: [],\r\n    profiles: [],\r\n    courses: [],\r\n    subjects: [],\r\n    projects: [],\r\n    cards: [],\r\n    langs: [],\r\n    featured: 0\r\n  };\r\n\r\n  [err, school] = await to(School.findById(schoolId));\r\n  let coursesId = [];\r\n  [err, data, coursesId] = await Course.getBySchool(school);\r\n\r\n  statistics['schoolCourses'] = coursesId;\r\n  statistics['courses'] = data;\r\n\r\n  let subjectsId = [];\r\n  [err, data, subjectsId] = await Subject.getByCourses(data, true);\r\n\r\n  statistics['schoolSubjects'] = subjectsId;\r\n  statistics['subjects'] = data;\r\n\r\n  let projectsId = [];\r\n  [err, data, projectsId] = await Project.getBySubjects(data);\r\n\r\n  statistics['schoolProjects'] = projectsId;\r\n  statistics['projects'] = data;\r\n\r\n  let cardsId = [];\r\n  let featured = 0;\r\n  [err, data, cardsId, featured] = await Card.getByProjects(data);\r\n\r\n  statistics['schoolCards'] = cardsId;\r\n  statistics['cards'] = data;\r\n  statistics['featured'] = featured;\r\n\r\n  let langsId = [];\r\n  [err, data, langsId] = await Lang.getByCards(data);\r\n\r\n  statistics['schoolLangs'] = langsId;\r\n  statistics['langs'] = data;\r\n\r\n  let profilesId = [];\r\n  [err, data, profilesId] = await Profile.getTeachers(schoolId);\r\n\r\n  statistics['schoolTeachers'] = profilesId;\r\n  statistics['profiles'] = data;\r\n\r\n  [err, data, profilesId] = await Profile.getStudents(statistics.schoolCourses);\r\n\r\n  statistics['schoolStudents'] = profilesId;\r\n  statistics['profiles'] = [...statistics['profiles'], ...data];\r\n\r\n  return [err, statistics];\r\n}\r\n"]}